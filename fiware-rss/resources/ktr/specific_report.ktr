<?xml version="1.0" encoding="UTF-8"?>
<transformation>
  <info>
    <name>specific_report</name>
    <description>specific report</description>
    <extended_description>This report reads a generic report csv file.
It calculates RS percentage to apply and calculates incomes.
Finally, report formats results and puts into csv and excel file. 

PARAMETERS:
baseDir		        root directory for files generated by transformation
genericFileName		generic file name to be transformed
obName		        operator name (for directory route purposes)
appProviderName		partner name (for directory route purposes)
</extended_description>
    <trans_version>7.0</trans_version>
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>&#47;</directory>
    <parameters>
        <parameter>
            <name>appProviderId</name>
            <default_value>TelecomItalia</default_value>
            <description/>
        </parameter>
        <parameter>
            <name>appProviderName</name>
            <default_value>Telecom Italia</default_value>
            <description> </description>
        </parameter>
        <parameter>
            <name>baseDir</name>
            <default_value>c:</default_value>
            <description/>
        </parameter>
        <parameter>
            <name>countryId</name>
            <default_value>1</default_value>
            <description/>
        </parameter>
        <parameter>
            <name>countryName</name>
            <default_value>ES</default_value>
            <description> </description>
        </parameter>
        <parameter>
            <name>endPeriod</name>
            <default_value>2013-12</default_value>
            <description> </description>
        </parameter>
        <parameter>
            <name>genericFileName</name>
            <default_value>generic_report_Telecom Italia_4CaaSt_ES_2013-01_2013-12.csv</default_value>
            <description/>
        </parameter>
        <parameter>
            <name>obName</name>
            <default_value>4CaaSt</default_value>
            <description> </description>
        </parameter>
        <parameter>
            <name>operatorId</name>
            <default_value>1</default_value>
            <description> </description>
        </parameter>
        <parameter>
            <name>startPeriod</name>
            <default_value>2013-01</default_value>
            <description/>
        </parameter>
    </parameters>
    <log>
<trans-log-table><connection/>
<schema/>
<table/>
<size_limit_lines/>
<interval/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>TRANSNAME</id><enabled>Y</enabled><name>TRANSNAME</name></field><field><id>STATUS</id><enabled>Y</enabled><name>STATUS</name></field><field><id>LINES_READ</id><enabled>Y</enabled><name>LINES_READ</name><subject/></field><field><id>LINES_WRITTEN</id><enabled>Y</enabled><name>LINES_WRITTEN</name><subject/></field><field><id>LINES_UPDATED</id><enabled>Y</enabled><name>LINES_UPDATED</name><subject/></field><field><id>LINES_INPUT</id><enabled>Y</enabled><name>LINES_INPUT</name><subject/></field><field><id>LINES_OUTPUT</id><enabled>Y</enabled><name>LINES_OUTPUT</name><subject/></field><field><id>LINES_REJECTED</id><enabled>Y</enabled><name>LINES_REJECTED</name><subject/></field><field><id>ERRORS</id><enabled>Y</enabled><name>ERRORS</name></field><field><id>STARTDATE</id><enabled>Y</enabled><name>STARTDATE</name></field><field><id>ENDDATE</id><enabled>Y</enabled><name>ENDDATE</name></field><field><id>LOGDATE</id><enabled>Y</enabled><name>LOGDATE</name></field><field><id>DEPDATE</id><enabled>Y</enabled><name>DEPDATE</name></field><field><id>REPLAYDATE</id><enabled>Y</enabled><name>REPLAYDATE</name></field><field><id>LOG_FIELD</id><enabled>Y</enabled><name>LOG_FIELD</name></field></trans-log-table>
<perf-log-table><connection/>
<schema/>
<table/>
<interval/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>SEQ_NR</id><enabled>Y</enabled><name>SEQ_NR</name></field><field><id>LOGDATE</id><enabled>Y</enabled><name>LOGDATE</name></field><field><id>TRANSNAME</id><enabled>Y</enabled><name>TRANSNAME</name></field><field><id>STEPNAME</id><enabled>Y</enabled><name>STEPNAME</name></field><field><id>STEP_COPY</id><enabled>Y</enabled><name>STEP_COPY</name></field><field><id>LINES_READ</id><enabled>Y</enabled><name>LINES_READ</name></field><field><id>LINES_WRITTEN</id><enabled>Y</enabled><name>LINES_WRITTEN</name></field><field><id>LINES_UPDATED</id><enabled>Y</enabled><name>LINES_UPDATED</name></field><field><id>LINES_INPUT</id><enabled>Y</enabled><name>LINES_INPUT</name></field><field><id>LINES_OUTPUT</id><enabled>Y</enabled><name>LINES_OUTPUT</name></field><field><id>LINES_REJECTED</id><enabled>Y</enabled><name>LINES_REJECTED</name></field><field><id>ERRORS</id><enabled>Y</enabled><name>ERRORS</name></field><field><id>INPUT_BUFFER_ROWS</id><enabled>Y</enabled><name>INPUT_BUFFER_ROWS</name></field><field><id>OUTPUT_BUFFER_ROWS</id><enabled>Y</enabled><name>OUTPUT_BUFFER_ROWS</name></field></perf-log-table>
<channel-log-table><connection/>
<schema/>
<table/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>LOG_DATE</id><enabled>Y</enabled><name>LOG_DATE</name></field><field><id>LOGGING_OBJECT_TYPE</id><enabled>Y</enabled><name>LOGGING_OBJECT_TYPE</name></field><field><id>OBJECT_NAME</id><enabled>Y</enabled><name>OBJECT_NAME</name></field><field><id>OBJECT_COPY</id><enabled>Y</enabled><name>OBJECT_COPY</name></field><field><id>REPOSITORY_DIRECTORY</id><enabled>Y</enabled><name>REPOSITORY_DIRECTORY</name></field><field><id>FILENAME</id><enabled>Y</enabled><name>FILENAME</name></field><field><id>OBJECT_ID</id><enabled>Y</enabled><name>OBJECT_ID</name></field><field><id>OBJECT_REVISION</id><enabled>Y</enabled><name>OBJECT_REVISION</name></field><field><id>PARENT_CHANNEL_ID</id><enabled>Y</enabled><name>PARENT_CHANNEL_ID</name></field><field><id>ROOT_CHANNEL_ID</id><enabled>Y</enabled><name>ROOT_CHANNEL_ID</name></field></channel-log-table>
<step-log-table><connection/>
<schema/>
<table/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>LOG_DATE</id><enabled>Y</enabled><name>LOG_DATE</name></field><field><id>TRANSNAME</id><enabled>Y</enabled><name>TRANSNAME</name></field><field><id>STEPNAME</id><enabled>Y</enabled><name>STEPNAME</name></field><field><id>STEP_COPY</id><enabled>Y</enabled><name>STEP_COPY</name></field><field><id>LINES_READ</id><enabled>Y</enabled><name>LINES_READ</name></field><field><id>LINES_WRITTEN</id><enabled>Y</enabled><name>LINES_WRITTEN</name></field><field><id>LINES_UPDATED</id><enabled>Y</enabled><name>LINES_UPDATED</name></field><field><id>LINES_INPUT</id><enabled>Y</enabled><name>LINES_INPUT</name></field><field><id>LINES_OUTPUT</id><enabled>Y</enabled><name>LINES_OUTPUT</name></field><field><id>LINES_REJECTED</id><enabled>Y</enabled><name>LINES_REJECTED</name></field><field><id>ERRORS</id><enabled>Y</enabled><name>ERRORS</name></field><field><id>LOG_FIELD</id><enabled>N</enabled><name>LOG_FIELD</name></field></step-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
  <created_user>-</created_user>
  <created_date>2012&#47;10&#47;08 14:13:57.734</created_date>
  <modified_user>-</modified_user>
  <modified_date>2012&#47;10&#47;08 14:13:57.734</modified_date>
  </info>
  <notepads>
  </notepads>
  <connection>
    <name>bmps</name>
    <server>10.95.26.99</server>
    <type>ORACLE</type>
    <access>JNDI</access>
    <database>bmps</database>
    <port>1521</port>
    <username/>
    <password>Encrypted </password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1521</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>N</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>dbe</name>
    <server/>
    <type>ORACLE</type>
    <access>JNDI</access>
    <database>dbe</database>
    <port>-1</port>
    <username/>
    <password>Encrypted </password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>-1</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>N</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>INT_BMPS20</name>
    <server>10.95.26.99</server>
    <type>ORACLE</type>
    <access>Native</access>
    <database>BMRS</database>
    <port>1521</port>
    <username>bmps_v5_0_0</username>
    <password>Encrypted 2be98afc86aa7f2e4cb1ba362cdc3fd89</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1521</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>N</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>INT_RSS20</name>
    <server>10.95.26.99</server>
    <type>ORACLE</type>
    <access>Native</access>
    <database>BMRS</database>
    <port>1521</port>
    <username>rss_v5_0_0</username>
    <password>Encrypted 2be98afc86aa7f2e4cb1ba362cdc3fd89</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1521</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>N</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>QA BMPS</name>
    <server>10.95.26.99</server>
    <type>ORACLE</type>
    <access>JNDI</access>
    <database>bmps</database>
    <port>1521</port>
    <username/>
    <password>Encrypted </password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1521</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>N</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>QA RSS</name>
    <server/>
    <type>ORACLE</type>
    <access>JNDI</access>
    <database>rss</database>
    <port>-1</port>
    <username/>
    <password>Encrypted </password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>-1</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>N</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>QA_BMPS_2_1</name>
    <server>10.95.26.99</server>
    <type>ORACLE</type>
    <access>Native</access>
    <database>BMRS</database>
    <port>1521</port>
    <username>bmps</username>
    <password>Encrypted 2be98afc86aa7f2e4cb1ba362cdc3fd89</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1521</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>N</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>QA_RSS_2_1</name>
    <server>10.95.26.99</server>
    <type>ORACLE</type>
    <access>Native</access>
    <database>BMRS</database>
    <port>1521</port>
    <username>rss</username>
    <password>Encrypted 2be98afc86aa7f2e4cb1ba362cdc3fd89</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1521</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>N</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>rss</name>
    <server>10.95.26.99</server>
    <type>ORACLE</type>
    <access>JNDI</access>
    <database>rss</database>
    <port>1521</port>
    <username/>
    <password>Encrypted </password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1521</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>N</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>settlement</name>
    <server/>
    <type>MYSQL</type>
    <access>JNDI</access>
    <database>settlement</database>
    <port>1521</port>
    <username/>
    <password>Encrypted </password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>EXTRA_OPTION_MYSQL.defaultFetchSize</code><attribute>500</attribute></attribute>
      <attribute><code>EXTRA_OPTION_MYSQL.useCursorFetch</code><attribute>true</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1521</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>STREAM_RESULTS</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>N</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <order>
  <hop> <from>Mapper Transaction Type</from><to>sort by rating_timestamp</to><enabled>Y</enabled> </hop>  <hop> <from>Merge Join</from><to>Append streams</to><enabled>Y</enabled> </hop>  <hop> <from>Percentage per OB</from><to>RS-CDRs Join</to><enabled>Y</enabled> </hop>  <hop> <from>Sort rows</from><to>Merge Join</to><enabled>Y</enabled> </hop>  <hop> <from>Sort rows</from><to>select fields for charge search</to><enabled>Y</enabled> </hop>  <hop> <from>Switch &#47; Case</from><to>Sort rows</to><enabled>Y</enabled> </hop>  <hop> <from>Switch &#47; Case</from><to>create empty refund fields</to><enabled>Y</enabled> </hop>  <hop> <from>calculate total operations</from><to>create totals line</to><enabled>Y</enabled> </hop>  <hop> <from>create empty refund fields</from><to>Append streams</to><enabled>Y</enabled> </hop>  <hop> <from>get charge data</from><to>Merge Join</to><enabled>Y</enabled> </hop>  <hop> <from>prepare operator_id field</from><to>sort for Rs join</to><enabled>Y</enabled> </hop>  <hop> <from>remove unused fields</from><to>Switch &#47; Case</to><enabled>Y</enabled> </hop>  <hop> <from>select field to calculate total</from><to>calculate total operations</to><enabled>Y</enabled> </hop>  <hop> <from>select fields for charge search</from><to>get charge data</to><enabled>Y</enabled> </hop>  <hop> <from>sort by rating_timestamp</from><to>Wait for header</to><enabled>Y</enabled> </hop>  <hop> <from>sort for Rs join</from><to>RS-CDRs Join</to><enabled>Y</enabled> </hop>  <hop> <from>read generic report CSV</from><to>Switch &#47; Case status</to><enabled>Y</enabled> </hop>  <hop> <from>Switch &#47; Case status</from><to>prepare operator_id field</to><enabled>Y</enabled> </hop>  <hop> <from>Switch &#47; Case status</from><to>line filtered: check status</to><enabled>Y</enabled> </hop>  <hop> <from>create totals line</from><to>Wait for report</to><enabled>Y</enabled> </hop>  <hop> <from>sort by rating_timestamp</from><to>select field to calculate total</to><enabled>Y</enabled> </hop>  <hop> <from>prepare data for rs-join</from><to>Selecciona TRANSACTION_ID</to><enabled>Y</enabled> </hop>  <hop> <from>Selecciona TRANSACTION_ID</from><to>Get OP_ATTRIBUTES</to><enabled>Y</enabled> </hop>  <hop> <from>Get OP_ATTRIBUTES</from><to>Divide OP_ATTRIBUTES</to><enabled>Y</enabled> </hop>  <hop> <from>prepare data for rs-join</from><to>Order by TRANSACTION_ID 1</to><enabled>Y</enabled> </hop>  <hop> <from>Order by TRANSACTION_ID 1</from><to>Join by TRANSACTION_ID</to><enabled>Y</enabled> </hop>  <hop> <from>Join by TRANSACTION_ID</from><to>remove unused fields</to><enabled>Y</enabled> </hop>  <hop> <from>Divide OP_ATTRIBUTES</from><to>Order by TRANSACTION_ID 2</to><enabled>Y</enabled> </hop>  <hop> <from>Order by TRANSACTION_ID 2</from><to>Join by TRANSACTION_ID</to><enabled>Y</enabled> </hop>  <hop> <from>Wait for header</from><to>select report fields</to><enabled>Y</enabled> </hop>  <hop> <from>select report fields</from><to>Ordenar por applicationId y eventId</to><enabled>Y</enabled> </hop>  <hop> <from>Ordenar por applicationId y eventId</from><to>Agrupar por applicationId y eventId</to><enabled>Y</enabled> </hop>  <hop> <from>RS-CDRs Join</from><to>Juntar Filas (producto cartesiano)</to><enabled>Y</enabled> </hop>  <hop> <from>Juntar Filas (producto cartesiano)</from><to>prepare data for rs-join</to><enabled>Y</enabled> </hop>  <hop> <from>Percentage per OB without product_class</from><to>Detect empty stream</to><enabled>Y</enabled> </hop>  <hop> <from>Detect empty stream</from><to>Append streams 2</to><enabled>Y</enabled> </hop>  <hop> <from>Percentage per OB without product_class</from><to>Append streams 2</to><enabled>Y</enabled> </hop>  <hop> <from>Append streams 2</from><to>Juntar Filas (producto cartesiano)</to><enabled>Y</enabled> </hop>  <hop> <from>Obtener Variables</from><to>Write header</to><enabled>Y</enabled> </hop>  <hop> <from>Agrupar por applicationId y eventId</from><to>Write report</to><enabled>Y</enabled> </hop>  <hop> <from>Wait for report</from><to>Write total</to><enabled>Y</enabled> </hop>  <hop> <from>create totals line</from><to>Obtener Variables</to><enabled>Y</enabled> </hop>  <hop> <from>Append streams</from><to>check refund operations</to><enabled>Y</enabled> </hop>  <hop> <from>check refund operations</from><to>Calculate RevenueShare</to><enabled>Y</enabled> </hop>  <hop> <from>Calculate RevenueShare</from><to>Mapper Transaction Type</to><enabled>Y</enabled> </hop>  </order>
  <step>
    <name>Agrupar por applicationId y eventId</name>
    <type>GroupBy</type>
    <description/>
    <distribute>N</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
      <all_rows>N</all_rows>
      <ignore_aggregate>N</ignore_aggregate>
      <field_ignore/>
      <directory>%%java.io.tmpdir%%</directory>
      <prefix>grp</prefix>
      <add_linenr>N</add_linenr>
      <linenr_fieldname/>
      <give_back_row>Y</give_back_row>
      <group>
        <field>
          <name>APPLICATION_ID</name>
        </field>
        <field>
          <name>APPLICATION_CLASS</name>
        </field>
        <field>
          <name>EVENT_ID</name>
        </field>
      </group>
      <fields>
        <field>
          <aggregate>GROSS_AMOUNT</aggregate>
          <subject>GROSS_AMOUNT</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>TAX_AMOUNT</aggregate>
          <subject>TAX_AMOUNT</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>TOTAL_AMOUNT</aggregate>
          <subject>TOTAL_AMOUNT</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>RS_PERCENTAGE</aggregate>
          <subject>RS_PERCENTAGE</subject>
          <type>FIRST</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>CURRENCY</aggregate>
          <subject>CURRENCY</subject>
          <type>FIRST</type>
          <valuefield/>
        </field>
      </fields>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>1250</xloc>
      <yloc>825</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Append streams</name>
    <type>Append</type>
    <description/>
    <distribute>N</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
<head_name>create empty refund fields</head_name>
<tail_name>Merge Join</tail_name>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>850</xloc>
      <yloc>525</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Append streams 2</name>
    <type>Append</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
<head_name>Percentage per OB without product_class</head_name>
<tail_name>Detect empty stream</tail_name>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>550</xloc>
      <yloc>75</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Calculate RevenueShare</name>
    <type>Calculator</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
       <calculation><field_name>GROSS_RS</field_name>
<calc_type>MULTIPLY</calc_type>
<field_a>rsAmount</field_a>
<field_b>finalParameterValue</field_b>
<field_c/>
<value_type>Number</value_type>
<value_length>-1</value_length>
<value_precision>2</value_precision>
<remove>N</remove>
<conversion_mask/>
<decimal_symbol/>
<grouping_symbol/>
<currency_symbol/>
</calculation>
       <calculation><field_name>TAXES_RS</field_name>
<calc_type>MULTIPLY</calc_type>
<field_a>finalTaxes</field_a>
<field_b>finalParameterValue</field_b>
<field_c/>
<value_type>Number</value_type>
<value_length>-1</value_length>
<value_precision>2</value_precision>
<remove>N</remove>
<conversion_mask/>
<decimal_symbol/>
<grouping_symbol/>
<currency_symbol/>
</calculation>
       <calculation><field_name>TOTAL_RS</field_name>
<calc_type>MULTIPLY</calc_type>
<field_a>finalAftTaxes</field_a>
<field_b>finalParameterValue</field_b>
<field_c/>
<value_type>Number</value_type>
<value_length>-1</value_length>
<value_precision>2</value_precision>
<remove>N</remove>
<conversion_mask/>
<decimal_symbol>.</decimal_symbol>
<grouping_symbol/>
<currency_symbol/>
</calculation>
       <calculation><field_name>microRS</field_name>
<calc_type>SUBTRACT</calc_type>
<field_a>finalAftTaxes</field_a>
<field_b>TOTAL_RS</field_b>
<field_c/>
<value_type>Number</value_type>
<value_length>-1</value_length>
<value_precision>2</value_precision>
<remove>N</remove>
<conversion_mask/>
<decimal_symbol>.</decimal_symbol>
<grouping_symbol/>
<currency_symbol/>
</calculation>
       <calculation><field_name>CTE_100</field_name>
<calc_type>CONSTANT</calc_type>
<field_a>100</field_a>
<field_b/>
<field_c/>
<value_type>Number</value_type>
<value_length>-1</value_length>
<value_precision>0</value_precision>
<remove>N</remove>
<conversion_mask/>
<decimal_symbol/>
<grouping_symbol/>
<currency_symbol/>
</calculation>
       <calculation><field_name>RS_PERCENTAGE</field_name>
<calc_type>MULTIPLY</calc_type>
<field_a>finalParameterValue</field_a>
<field_b>CTE_100</field_b>
<field_c/>
<value_type>Number</value_type>
<value_length>-1</value_length>
<value_precision>2</value_precision>
<remove>N</remove>
<conversion_mask/>
<decimal_symbol>.</decimal_symbol>
<grouping_symbol/>
<currency_symbol/>
</calculation>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>1050</xloc>
      <yloc>525</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Detect empty stream</name>
    <type>DetectEmptyStream</type>
    <description/>
    <distribute>N</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>650</xloc>
      <yloc>50</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Divide OP_ATTRIBUTES</name>
    <type>FieldSplitter</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
   <splitfield>tx_op_attributes</splitfield>
   <delimiter>#</delimiter>
    <fields>      <field>        <name>EVENT_ID</name>
        <id/>
        <idrem>N</idrem>
        <type>String</type>
        <format/>
        <group/>
        <decimal/>
        <length>-1</length>
        <precision>-1</precision>
        <nullif/>
        <ifnull/>
        <trimtype>both</trimtype>
      </field>      <field>        <name>PARENT_APP_ID</name>
        <id/>
        <idrem>N</idrem>
        <type>String</type>
        <format/>
        <group/>
        <decimal/>
        <length>-1</length>
        <precision>-1</precision>
        <nullif/>
        <ifnull/>
        <trimtype>both</trimtype>
      </field>      <field>        <name>PURCHASE_CODE</name>
        <id/>
        <idrem>N</idrem>
        <type>String</type>
        <format/>
        <group/>
        <decimal/>
        <length>-1</length>
        <precision>-1</precision>
        <nullif/>
        <ifnull/>
        <trimtype>both</trimtype>
      </field>    </fields>     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>850</xloc>
      <yloc>225</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Get OP_ATTRIBUTES</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <connection>settlement</connection>
    <sql>SELECT tx_transaction_id as TRANSACTION_ID, tx_op_attributes, tx_paymentmethod_code as PAYMENT_METHOD FROM dbe_transaction, bm_pb_mop WHERE dbe_transaction.nu_internal_mop_id = bm_pb_mop.nu_mop_id AND tx_transaction_id = ? ORDER BY tx_transaction_id ASC</sql>
    <limit>0</limit>
    <lookup>Selecciona TRANSACTION_ID</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>850</xloc>
      <yloc>125</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Join by TRANSACTION_ID</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
<join_type>LEFT OUTER</join_type>
<step1>Order by TRANSACTION_ID 1</step1>
<step2>Order by TRANSACTION_ID 2</step2>
    <keys_1>
      <key>TRANSACTION_ID</key>
    </keys_1>
    <keys_2>
      <key>TRANSACTION_ID</key>
    </keys_2>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>650</xloc>
      <yloc>325</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Juntar Filas (producto cartesiano)</name>
    <type>JoinRows</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
      <directory>%%java.io.tmpdir%%</directory>
      <prefix>out</prefix>
      <cache_size>500</cache_size>
      <main>RS-CDRs Join</main>
    <compare>
<condition>
 <negated>N</negated>
 <leftvalue>TRANSACTION_ID</leftvalue>
 <function>IS NOT NULL</function>
 <rightvalue/>
 </condition>
    </compare>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>550</xloc>
      <yloc>125</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Mapper Transaction Type</name>
    <type>ValueMapper</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <field_to_use>OPERATION</field_to_use>
    <target_field/>
    <non_match_default/>
    <fields>
      <field>
        <source_value>Charge</source_value>
        <target_value>1</target_value>
      </field>
      <field>
        <source_value>Refund</source_value>
        <target_value>3</target_value>
      </field>
      <field>
        <source_value>Preserv</source_value>
        <target_value>1</target_value>
      </field>
      <field>
        <source_value>Capture</source_value>
        <target_value>1</target_value>
      </field>
    </fields>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>1150</xloc>
      <yloc>525</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Merge Join</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
<join_type>LEFT OUTER</join_type>
<step1>Sort rows</step1>
<step2>get charge data</step2>
    <keys_1>
      <key>ORG_TRANSACTION_ID</key>
    </keys_1>
    <keys_2>
      <key>PARENT_TRANSACTION_ID</key>
    </keys_2>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>850</xloc>
      <yloc>700</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Obtener Variables</name>
    <type>GetVariable</type>
    <description/>
    <distribute>N</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <fields>
      <field>
        <name>Service Provider</name>
        <variable>${appProviderName}</variable>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
      </field>
      <field>
        <name>Period Start</name>
        <variable>${startPeriod}</variable>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
      </field>
      <field>
        <name>Period End</name>
        <variable>${endPeriod}</variable>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
      </field>
    </fields>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>1650</xloc>
      <yloc>525</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Ordenar por applicationId y eventId</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
      <directory>%%java.io.tmpdir%%</directory>
      <prefix>out</prefix>
      <sort_size>1000000</sort_size>
      <free_memory/>
      <compress>N</compress>
      <compress_variable/>
      <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>APPLICATION_ID</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
      </field>
      <field>
        <name>APPLICATION_CLASS</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
      </field>
      <field>
        <name>EVENT_ID</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
      </field>
    </fields>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>1250</xloc>
      <yloc>750</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Order by TRANSACTION_ID 1</name>
    <type>SortRows</type>
    <description/>
    <distribute>N</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
      <directory>%%java.io.tmpdir%%</directory>
      <prefix>out</prefix>
      <sort_size>1000000</sort_size>
      <free_memory/>
      <compress>N</compress>
      <compress_variable/>
      <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>TRANSACTION_ID</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
      </field>
    </fields>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>650</xloc>
      <yloc>225</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Order by TRANSACTION_ID 2</name>
    <type>SortRows</type>
    <description/>
    <distribute>N</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
      <directory>%%java.io.tmpdir%%</directory>
      <prefix>out</prefix>
      <sort_size>1000000</sort_size>
      <free_memory/>
      <compress>N</compress>
      <compress_variable/>
      <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>TRANSACTION_ID</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
      </field>
    </fields>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>850</xloc>
      <yloc>325</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Percentage per OB</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <connection>settlement</connection>
    <sql>select 
 tx_product_class as product_id,
 nu_perc_revenue_share&#47;100 as parameter_value
 from set_revenue_share_conf 
 where 
 tx_appprovider_id = &apos;${appProviderId}&apos; and
 nu_ob_id = &apos;${operatorId}&apos; and
 nu_country_id  = &apos;${countryId}&apos;
 order by product_id asc

</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>450</xloc>
      <yloc>25</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Percentage per OB without product_class</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <connection>settlement</connection>
    <sql>select 
 nu_perc_revenue_share&#47;100 as parameter_value_1
 from set_revenue_share_conf 
 where 
 tx_appprovider_id = &apos;${appProviderId}&apos; and
 nu_ob_id = &apos;${operatorId}&apos; and
 nu_country_id  = &apos;${countryId}&apos; and
 tx_product_class = &apos;&apos;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>550</xloc>
      <yloc>25</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>RS-CDRs Join</name>
    <type>MergeJoin</type>
    <description/>
    <distribute>N</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
<join_type>LEFT OUTER</join_type>
<step1>sort for Rs join</step1>
<step2>Percentage per OB</step2>
    <keys_1>
      <key>PRODUCT_CLASS</key>
    </keys_1>
    <keys_2>
      <key>PRODUCT_ID</key>
    </keys_2>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>450</xloc>
      <yloc>125</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Selecciona TRANSACTION_ID</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <fields>      <field>        <name>MSISDN</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>OPERATION</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>TRANSACTION_ID</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>TRANSACTION_STATUS</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>REFERENCE_CODE</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>ORG_TRANSACTION_ID</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>RATING_TIMESTAMP</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>AMOUNT</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>TAXES_AMOUNT</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>TOTAL_AMOUNT</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>CURRENCY</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>OPERATOR_CODE</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>PRODUCT_CLASS</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>PB_CORRELATION_ID</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>DESCRIPTION_TEXT</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>APP_ID</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>REFUND_REASON</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>OPERATOR_ID</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>product_id</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>parameter_value</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>rsAmount</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>finalTaxes</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>finalAftTaxes</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>grossAmount</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>finalParameterValue</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>        <select_unspecified>N</select_unspecified>
      <remove>        <name>MSISDN</name>
      </remove>      <remove>        <name>OPERATION</name>
      </remove>      <remove>        <name>TRANSACTION_STATUS</name>
      </remove>      <remove>        <name>REFERENCE_CODE</name>
      </remove>      <remove>        <name>ORG_TRANSACTION_ID</name>
      </remove>      <remove>        <name>RATING_TIMESTAMP</name>
      </remove>      <remove>        <name>AMOUNT</name>
      </remove>      <remove>        <name>TAXES_AMOUNT</name>
      </remove>      <remove>        <name>TOTAL_AMOUNT</name>
      </remove>      <remove>        <name>CURRENCY</name>
      </remove>      <remove>        <name>OPERATOR_CODE</name>
      </remove>      <remove>        <name>PRODUCT_CLASS</name>
      </remove>      <remove>        <name>PB_CORRELATION_ID</name>
      </remove>      <remove>        <name>DESCRIPTION_TEXT</name>
      </remove>      <remove>        <name>APP_ID</name>
      </remove>      <remove>        <name>REFUND_REASON</name>
      </remove>      <remove>        <name>OPERATOR_ID</name>
      </remove>      <remove>        <name>product_id</name>
      </remove>      <remove>        <name>parameter_value</name>
      </remove>      <remove>        <name>rsAmount</name>
      </remove>      <remove>        <name>finalTaxes</name>
      </remove>      <remove>        <name>finalAftTaxes</name>
      </remove>      <remove>        <name>grossAmount</name>
      </remove>      <remove>        <name>finalParameterValue</name>
      </remove>    </fields>     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>750</xloc>
      <yloc>125</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Sort rows</name>
    <type>SortRows</type>
    <description/>
    <distribute>N</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
      <directory>%%java.io.tmpdir%%</directory>
      <prefix>out</prefix>
      <sort_size>1000000</sort_size>
      <free_memory/>
      <compress>N</compress>
      <compress_variable/>
      <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>ORG_TRANSACTION_ID</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
      </field>
    </fields>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>650</xloc>
      <yloc>700</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Switch &#47; Case</name>
    <type>SwitchCase</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
<fieldname>OPERATION</fieldname>
<use_contains>N</use_contains>
<case_value_type>String</case_value_type>
<case_value_format/>
<case_value_decimal/>
<case_value_group/>
<default_target_step>Sort rows</default_target_step>
<cases><case><value>Charge</value>
<target_step>create empty refund fields</target_step>
</case><case><value>Preserv</value>
<target_step>create empty refund fields</target_step>
</case><case><value>Capture</value>
<target_step>create empty refund fields</target_step>
</case><case><value>Refund</value>
<target_step>Sort rows</target_step>
</case></cases>     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>650</xloc>
      <yloc>525</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Switch &#47; Case status</name>
    <type>SwitchCase</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
<fieldname>TRANSACTION_STATUS</fieldname>
<use_contains>N</use_contains>
<case_value_type>String</case_value_type>
<case_value_format/>
<case_value_decimal/>
<case_value_group/>
<default_target_step>line filtered: check status</default_target_step>
<cases><case><value>Settled</value>
<target_step>prepare operator_id field</target_step>
</case><case><value>Compensated</value>
<target_step>prepare operator_id field</target_step>
</case><case><value>Captured</value>
<target_step>prepare operator_id field</target_step>
</case><case><value>Refunded</value>
<target_step>prepare operator_id field</target_step>
</case></cases>     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>150</xloc>
      <yloc>125</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Wait for header</name>
    <type>BlockUntilStepsFinish</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <steps>
      <step>
        <name>Write header</name>
        <CopyNr>0</CopyNr>
        </step>
      </steps>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>1250</xloc>
      <yloc>600</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Wait for report</name>
    <type>BlockUntilStepsFinish</type>
    <description/>
    <distribute>N</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <steps>
      <step>
        <name>Write report</name>
        <CopyNr>0</CopyNr>
        </step>
      </steps>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>1550</xloc>
      <yloc>600</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Write header</name>
    <type>TypeExitExcelWriterStep</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <header>Y</header>
    <footer>N</footer>
    <makeSheetActive>Y</makeSheetActive>
    <rowWritingMethod>overwrite</rowWritingMethod>
    <startingCell>A1</startingCell>
    <appendOmitHeader>N</appendOmitHeader>
    <appendOffset>0</appendOffset>
    <appendEmpty>0</appendEmpty>
    <rowWritingMethod>overwrite</rowWritingMethod>
    <forceFormulaRecalculation>N</forceFormulaRecalculation>
    <leaveExistingStylesUnchanged>N</leaveExistingStylesUnchanged>
    <appendLines>N</appendLines>
    <add_to_result_filenames>N</add_to_result_filenames>
    <file>
      <name>${baseDir}\${appProviderName}\${obName}_${countryName}\formatted\${appProviderName}-${obName}-${countryName}-${startPeriod}-TO-${endPeriod}</name>
      <extention>xls</extention>
      <do_not_open_newfile_init>Y</do_not_open_newfile_init>
      <split>N</split>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <SpecifyFormat>N</SpecifyFormat>
      <date_time_format/>
      <sheetname>${appProviderName}</sheetname>
      <autosizecolums>N</autosizecolums>
      <stream_data>N</stream_data>
      <protect_sheet>N</protect_sheet>
      <password>Encrypted </password>
      <protected_by/>
      <splitevery>0</splitevery>
      <if_file_exists>new</if_file_exists>
      <if_sheet_exists>new</if_sheet_exists>
      </file>
    <template>
      <enabled>N</enabled>
      <sheet_enabled>N</sheet_enabled>
      <filename>template.xls</filename>
      <sheetname/>
    </template>
    <fields>
      <field>
        <name>Service Provider</name>
        <type>String</type>
        <format/>
        <title/>
        <titleStyleCell/>
        <styleCell/>
        <commentField/>
        <commentAuthorField/>
        <formula>N</formula>
        <hyperlinkField/>
      </field>
      <field>
        <name>Period Start</name>
        <type>String</type>
        <format/>
        <title/>
        <titleStyleCell/>
        <styleCell/>
        <commentField/>
        <commentAuthorField/>
        <formula>N</formula>
        <hyperlinkField/>
      </field>
      <field>
        <name>Period End</name>
        <type>String</type>
        <format/>
        <title/>
        <titleStyleCell/>
        <styleCell/>
        <commentField/>
        <commentAuthorField/>
        <formula>N</formula>
        <hyperlinkField/>
      </field>
      <field>
        <name>Payment Method</name>
        <type>String</type>
        <format/>
        <title/>
        <titleStyleCell/>
        <styleCell/>
        <commentField/>
        <commentAuthorField/>
        <formula>N</formula>
        <hyperlinkField/>
      </field>
    </fields>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>1750</xloc>
      <yloc>525</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Write report</name>
    <type>TypeExitExcelWriterStep</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <header>Y</header>
    <footer>N</footer>
    <makeSheetActive>Y</makeSheetActive>
    <rowWritingMethod>overwrite</rowWritingMethod>
    <startingCell>A1</startingCell>
    <appendOmitHeader>N</appendOmitHeader>
    <appendOffset>0</appendOffset>
    <appendEmpty>0</appendEmpty>
    <rowWritingMethod>overwrite</rowWritingMethod>
    <forceFormulaRecalculation>N</forceFormulaRecalculation>
    <leaveExistingStylesUnchanged>N</leaveExistingStylesUnchanged>
    <appendLines>Y</appendLines>
    <add_to_result_filenames>N</add_to_result_filenames>
    <file>
      <name>${baseDir}\${appProviderName}\${obName}_${countryName}\formatted\${appProviderName}-${obName}-${countryName}-${startPeriod}-TO-${endPeriod}</name>
      <extention>xls</extention>
      <do_not_open_newfile_init>Y</do_not_open_newfile_init>
      <split>N</split>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <SpecifyFormat>N</SpecifyFormat>
      <date_time_format/>
      <sheetname>${appProviderName}</sheetname>
      <autosizecolums>N</autosizecolums>
      <stream_data>N</stream_data>
      <protect_sheet>N</protect_sheet>
      <password>Encrypted </password>
      <protected_by/>
      <splitevery>0</splitevery>
      <if_file_exists>reuse</if_file_exists>
      <if_sheet_exists>reuse</if_sheet_exists>
      </file>
    <template>
      <enabled>N</enabled>
      <sheet_enabled>N</sheet_enabled>
      <filename>template.xls</filename>
      <sheetname/>
    </template>
    <fields>
      <field>
        <name>APPLICATION_ID</name>
        <type>String</type>
        <format/>
        <title/>
        <titleStyleCell/>
        <styleCell/>
        <commentField/>
        <commentAuthorField/>
        <formula>N</formula>
        <hyperlinkField/>
      </field>
      <field>
        <name>APPLICATION_CLASS</name>
        <type>String</type>
        <format/>
        <title/>
        <titleStyleCell/>
        <styleCell/>
        <commentField/>
        <commentAuthorField/>
        <formula>N</formula>
        <hyperlinkField/>
      </field>
      <field>
        <name>EVENT_ID</name>
        <type>String</type>
        <format/>
        <title/>
        <titleStyleCell/>
        <styleCell/>
        <commentField/>
        <commentAuthorField/>
        <formula>N</formula>
        <hyperlinkField/>
      </field>
      <field>
        <name>GROSS_AMOUNT</name>
        <type>Number</type>
        <format>0.00</format>
        <title/>
        <titleStyleCell/>
        <styleCell/>
        <commentField/>
        <commentAuthorField/>
        <formula>N</formula>
        <hyperlinkField/>
      </field>
      <field>
        <name>TAX_AMOUNT</name>
        <type>Number</type>
        <format>0.00</format>
        <title/>
        <titleStyleCell/>
        <styleCell/>
        <commentField/>
        <commentAuthorField/>
        <formula>N</formula>
        <hyperlinkField/>
      </field>
      <field>
        <name>TOTAL_AMOUNT</name>
        <type>Number</type>
        <format>0.00</format>
        <title/>
        <titleStyleCell/>
        <styleCell/>
        <commentField/>
        <commentAuthorField/>
        <formula>N</formula>
        <hyperlinkField/>
      </field>
      <field>
        <name>RS_PERCENTAGE</name>
        <type>Number</type>
        <format>0</format>
        <title/>
        <titleStyleCell/>
        <styleCell/>
        <commentField/>
        <commentAuthorField/>
        <formula>N</formula>
        <hyperlinkField/>
      </field>
      <field>
        <name>CURRENCY</name>
        <type>String</type>
        <format/>
        <title/>
        <titleStyleCell/>
        <styleCell/>
        <commentField/>
        <commentAuthorField/>
        <formula>N</formula>
        <hyperlinkField/>
      </field>
    </fields>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>1250</xloc>
      <yloc>900</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>Write total</name>
    <type>TypeExitExcelWriterStep</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <header>N</header>
    <footer>N</footer>
    <makeSheetActive>Y</makeSheetActive>
    <rowWritingMethod>overwrite</rowWritingMethod>
    <startingCell>A1</startingCell>
    <appendOmitHeader>N</appendOmitHeader>
    <appendOffset>0</appendOffset>
    <appendEmpty>0</appendEmpty>
    <rowWritingMethod>overwrite</rowWritingMethod>
    <forceFormulaRecalculation>N</forceFormulaRecalculation>
    <leaveExistingStylesUnchanged>N</leaveExistingStylesUnchanged>
    <appendLines>Y</appendLines>
    <add_to_result_filenames>N</add_to_result_filenames>
    <file>
      <name>${baseDir}\${appProviderName}\${obName}_${countryName}\formatted\${appProviderName}-${obName}-${countryName}-${startPeriod}-TO-${endPeriod}</name>
      <extention>xls</extention>
      <do_not_open_newfile_init>Y</do_not_open_newfile_init>
      <split>N</split>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <SpecifyFormat>N</SpecifyFormat>
      <date_time_format/>
      <sheetname>${appProviderName}</sheetname>
      <autosizecolums>Y</autosizecolums>
      <stream_data>N</stream_data>
      <protect_sheet>N</protect_sheet>
      <password>Encrypted </password>
      <protected_by/>
      <splitevery>0</splitevery>
      <if_file_exists>reuse</if_file_exists>
      <if_sheet_exists>reuse</if_sheet_exists>
      </file>
    <template>
      <enabled>N</enabled>
      <sheet_enabled>N</sheet_enabled>
      <filename>template.xls</filename>
      <sheetname/>
    </template>
    <fields>
      <field>
        <name>TOTAL</name>
        <type>String</type>
        <format/>
        <title/>
        <titleStyleCell/>
        <styleCell/>
        <commentField/>
        <commentAuthorField/>
        <formula>N</formula>
        <hyperlinkField/>
      </field>
      <field>
        <name>vacio</name>
        <type>String</type>
        <format/>
        <title/>
        <titleStyleCell/>
        <styleCell/>
        <commentField/>
        <commentAuthorField/>
        <formula>N</formula>
        <hyperlinkField/>
      </field>
      <field>
        <name>vacio</name>
        <type>String</type>
        <format/>
        <title/>
        <titleStyleCell/>
        <styleCell/>
        <commentField/>
        <commentAuthorField/>
        <formula>N</formula>
        <hyperlinkField/>
      </field>
      <field>
        <name>SUM_GROSS_RS</name>
        <type>Number</type>
        <format>0.00</format>
        <title/>
        <titleStyleCell/>
        <styleCell/>
        <commentField/>
        <commentAuthorField/>
        <formula>N</formula>
        <hyperlinkField/>
      </field>
      <field>
        <name>SUM_TAXES_RS</name>
        <type>Number</type>
        <format>0.00</format>
        <title/>
        <titleStyleCell/>
        <styleCell/>
        <commentField/>
        <commentAuthorField/>
        <formula>N</formula>
        <hyperlinkField/>
      </field>
      <field>
        <name>SUM_TOTAL_RS</name>
        <type>Number</type>
        <format>0.00</format>
        <title/>
        <titleStyleCell/>
        <styleCell/>
        <commentField/>
        <commentAuthorField/>
        <formula>N</formula>
        <hyperlinkField/>
      </field>
      <field>
        <name>vacio</name>
        <type>String</type>
        <format/>
        <title/>
        <titleStyleCell/>
        <styleCell/>
        <commentField/>
        <commentAuthorField/>
        <formula>N</formula>
        <hyperlinkField/>
      </field>
      <field>
        <name>CURRENCY</name>
        <type>String</type>
        <format/>
        <title/>
        <titleStyleCell/>
        <styleCell/>
        <commentField/>
        <commentAuthorField/>
        <formula>N</formula>
        <hyperlinkField/>
      </field>
    </fields>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>1550</xloc>
      <yloc>675</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>calculate total operations</name>
    <type>GroupBy</type>
    <description/>
    <distribute>N</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
      <all_rows>N</all_rows>
      <ignore_aggregate>N</ignore_aggregate>
      <field_ignore/>
      <directory>%%java.io.tmpdir%%</directory>
      <prefix>grp</prefix>
      <add_linenr>N</add_linenr>
      <linenr_fieldname/>
      <give_back_row>Y</give_back_row>
      <group>
      </group>
      <fields>
        <field>
          <aggregate>SUM_GROSS_RS</aggregate>
          <subject>GROSS_RS</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>SUM_TAXES_RS</aggregate>
          <subject>TAXES_RS</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>SUM_TOTAL_RS</aggregate>
          <subject>TOTAL_RS</subject>
          <type>SUM</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>CURRENCY</aggregate>
          <subject>CURRENCY</subject>
          <type>FIRST</type>
          <valuefield/>
        </field>
        <field>
          <aggregate>Payment Method</aggregate>
          <subject>Payment Method</subject>
          <type>FIRST</type>
          <valuefield/>
        </field>
      </fields>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>1450</xloc>
      <yloc>525</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>check refund operations</name>
    <type>Formula</type>
    <description/>
    <distribute>N</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
       <formula><field_name>rsAmount</field_name>
<formula_string>IF([OPERATION]=&quot;Refund&quot;;[REFUND_AMOUNT]*-1;[rsAmount])</formula_string>
<value_type>Number</value_type>
<value_length>9</value_length>
<value_precision>2</value_precision>
<replace_field>rsAmount</replace_field>
</formula>
       <formula><field_name>finalTaxes</field_name>
<formula_string>IF([OPERATION]=&quot;Refund&quot;;[REFUND_TAX_AMOUNT]*-1;[finalTaxes])</formula_string>
<value_type>Number</value_type>
<value_length>9</value_length>
<value_precision>2</value_precision>
<replace_field>finalTaxes</replace_field>
</formula>
       <formula><field_name>finalAftTaxes</field_name>
<formula_string>IF([OPERATION]=&quot;Refund&quot;;[REFUND_TOTAL_AMOUNT]*-1;[finalAftTaxes])</formula_string>
<value_type>Number</value_type>
<value_length>9</value_length>
<value_precision>2</value_precision>
<replace_field>finalAftTaxes</replace_field>
</formula>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>950</xloc>
      <yloc>525</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>create empty refund fields</name>
    <type>Constant</type>
    <description/>
    <distribute>N</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <fields>
      <field>
        <name>PARENT_TRANSACTION_ID</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <length>-1</length>
        <precision>-1</precision>
      </field>
      <field>
        <name>REFUND_AMOUNT</name>
        <type>Number</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <length>8</length>
        <precision>4</precision>
      </field>
      <field>
        <name>REFUND_TAX_AMOUNT</name>
        <type>Number</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <length>8</length>
        <precision>4</precision>
      </field>
      <field>
        <name>REFUND_TOTAL_AMOUNT</name>
        <type>Number</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <nullif/>
        <length>8</length>
        <precision>4</precision>
      </field>
    </fields>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>750</xloc>
      <yloc>525</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>create totals line</name>
    <type>Formula</type>
    <description/>
    <distribute>N</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
       <formula><field_name>TOTAL</field_name>
<formula_string>&quot;TOTAL&quot;</formula_string>
<value_type>String</value_type>
<value_length>-1</value_length>
<value_precision>-1</value_precision>
<replace_field/>
</formula>
       <formula><field_name>vacio</field_name>
<formula_string>&quot;&quot;</formula_string>
<value_type>String</value_type>
<value_length>-1</value_length>
<value_precision>-1</value_precision>
<replace_field/>
</formula>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>1550</xloc>
      <yloc>525</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>get charge data</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <connection>settlement</connection>
    <sql>select 
 tx_transaction_id as PARENT_TRANSACTION_ID,
 ft_request_amount as REFUND_AMOUNT,
 ft_request_tax_amount as REFUND_TAX_AMOUNT,
 ft_request_total_amount as REFUND_TOTAL_AMOUNT
 from dbe_transaction
 where 
 tx_transaction_id = ?
 and tc_transaction_type = &apos;C&apos;
 order by tx_transaction_id asc</sql>
    <limit>0</limit>
    <lookup>select fields for charge search</lookup>
    <execute_each_row>Y</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>850</xloc>
      <yloc>800</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>line filtered: check status</name>
    <type>Dummy</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>150</xloc>
      <yloc>225</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>prepare data for rs-join</name>
    <type>Formula</type>
    <description/>
    <distribute>N</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
       <formula><field_name>rsAmount</field_name>
<formula_string>IF(ISNA( [AMOUNT]);0.00;IF(ISBLANK([AMOUNT]);0.00;[AMOUNT]))</formula_string>
<value_type>Number</value_type>
<value_length>-1</value_length>
<value_precision>2</value_precision>
<replace_field/>
</formula>
       <formula><field_name>finalTaxes</field_name>
<formula_string>IF(ISNA([TAXES_AMOUNT]);0.00;IF(ISBLANK([TAXES_AMOUNT]);0.00;[TAXES_AMOUNT]))</formula_string>
<value_type>Number</value_type>
<value_length>-1</value_length>
<value_precision>2</value_precision>
<replace_field/>
</formula>
       <formula><field_name>finalAftTaxes</field_name>
<formula_string>IF(ISNA([TOTAL_AMOUNT]);0.00;IF(ISBLANK([TOTAL_AMOUNT]);0.00;[TOTAL_AMOUNT]))</formula_string>
<value_type>Number</value_type>
<value_length>-1</value_length>
<value_precision>2</value_precision>
<replace_field/>
</formula>
       <formula><field_name>grossAmount</field_name>
<formula_string>IF([OPERATION]&lt;&gt;&quot;Refund&quot;;IF(ISNA([TOTAL_AMOUNT]);0.00;IF(ISBLANK([TOTAL_AMOUNT]);0.00;[TOTAL_AMOUNT]));0.00)</formula_string>
<value_type>Number</value_type>
<value_length>-1</value_length>
<value_precision>2</value_precision>
<replace_field/>
</formula>
       <formula><field_name>finalParameterValue</field_name>
<formula_string>IF(ISBLANK([PARAMETER_VALUE]);IF(ISBLANK([PARAMETER_VALUE_1]);0.00;[PARAMETER_VALUE_1]);[PARAMETER_VALUE])</formula_string>
<value_type>Number</value_type>
<value_length>-1</value_length>
<value_precision>2</value_precision>
<replace_field/>
</formula>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>650</xloc>
      <yloc>125</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>prepare operator_id field</name>
    <type>Formula</type>
    <description/>
    <distribute>N</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
       <formula><field_name>OPERATOR_ID</field_name>
<formula_string>SUBSTITUTE([OPERATOR_CODE];&quot;-&quot;;&quot;&quot;)</formula_string>
<value_type>String</value_type>
<value_length>-1</value_length>
<value_precision>-1</value_precision>
<replace_field/>
</formula>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>250</xloc>
      <yloc>125</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>read generic report CSV</name>
    <type>CsvInput</type>
    <description/>
    <distribute>N</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <filename>${baseDir}\${appProviderName}\${obName}_${countryName}\generated\${genericFileName}</filename>
    <filename_field/>
    <rownum_field/>
    <include_filename>N</include_filename>
    <separator>#|#</separator>
    <enclosure/>
    <header>Y</header>
    <buffer_size>50000000</buffer_size>
    <lazy_conversion>N</lazy_conversion>
    <add_filename_result>N</add_filename_result>
    <parallel>N</parallel>
    <newline_possible>N</newline_possible>
    <encoding/>
    <fields>
      <field>
        <name>MSISDN</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal>.</decimal>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>OPERATION</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal>.</decimal>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>TRANSACTION_ID</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal>.</decimal>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>TRANSACTION_STATUS</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal>.</decimal>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>REFERENCE_CODE</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal>.</decimal>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>ORG_TRANSACTION_ID</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal>.</decimal>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>RATING_TIMESTAMP</name>
        <type>Date</type>
        <format/>
        <currency/>
        <decimal>.</decimal>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>AMOUNT</name>
        <type>Number</type>
        <format>0.00</format>
        <currency/>
        <decimal>.</decimal>
        <group/>
        <length>-1</length>
        <precision>2</precision>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>TAXES_AMOUNT</name>
        <type>Number</type>
        <format>0.00</format>
        <currency/>
        <decimal>.</decimal>
        <group/>
        <length>-1</length>
        <precision>2</precision>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>TOTAL_AMOUNT</name>
        <type>Number</type>
        <format>0.00</format>
        <currency/>
        <decimal>.</decimal>
        <group/>
        <length>-1</length>
        <precision>2</precision>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>CURRENCY</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal>.</decimal>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>OPERATOR_CODE</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal>.</decimal>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>PRODUCT_CLASS</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal>.</decimal>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>PB_CORRELATION_ID</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal>.</decimal>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>DESCRIPTION_TEXT</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal>.</decimal>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>APP_ID</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal>.</decimal>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>REFUND_REASON</name>
        <type>String</type>
        <format/>
        <currency/>
        <decimal>.</decimal>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
      </field>
    </fields>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>50</xloc>
      <yloc>125</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>remove unused fields</name>
    <type>SelectValues</type>
    <description/>
    <distribute>N</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <fields>      <field>        <name>MSISDN</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>OPERATION</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>TRANSACTION_ID</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>TRANSACTION_STATUS</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>REFERENCE_CODE</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>ORG_TRANSACTION_ID</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>RATING_TIMESTAMP</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>AMOUNT</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>TAXES_AMOUNT</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>TOTAL_AMOUNT</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>CURRENCY</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>OPERATOR_CODE</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>APP_ID</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>OPERATOR_ID</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>PRODUCT_ID</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>PARAMETER_VALUE</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>rsAmount</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>finalTaxes</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>finalAftTaxes</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>grossAmount</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>finalParameterValue</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>PRODUCT_CLASS</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>REFUND_REASON</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>PB_CORRELATION_ID</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>EVENT_ID</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>PARENT_APP_ID</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>PURCHASE_CODE</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>PAYMENT_METHOD</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>TRANSACTION_ID_1</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>        <select_unspecified>N</select_unspecified>
      <remove>        <name>MSISDN</name>
      </remove>      <remove>        <name>AMOUNT</name>
      </remove>      <remove>        <name>PRODUCT_ID</name>
      </remove>      <remove>        <name>PARAMETER_VALUE</name>
      </remove>      <remove>        <name>TRANSACTION_ID</name>
      </remove>      <remove>        <name>REFERENCE_CODE</name>
      </remove>      <remove>        <name>TRANSACTION_STATUS</name>
      </remove>      <remove>        <name>PARENT_APP_ID</name>
      </remove>      <remove>        <name>PURCHASE_CODE</name>
      </remove>      <remove>        <name>PB_CORRELATION_ID</name>
      </remove>      <remove>        <name>TRANSACTION_ID_1</name>
      </remove>      <remove>        <name>TAXES_AMOUNT</name>
      </remove>      <remove>        <name>TOTAL_AMOUNT</name>
      </remove>      <remove>        <name>grossAmount</name>
      </remove>    </fields>     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>650</xloc>
      <yloc>425</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>select field to calculate total</name>
    <type>SelectValues</type>
    <description/>
    <distribute>N</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <fields>      <field>        <name>OPERATION</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>ORG_TRANSACTION_ID</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>RATING_TIMESTAMP</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>CURRENCY</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>OPERATOR_CODE</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>APP_ID</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>OPERATOR_ID</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>rsAmount</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>finalTaxes</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>finalAftTaxes</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>finalParameterValue</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>PRODUCT_CLASS</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>REFUND_REASON</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>EVENT_ID</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>PAYMENT_METHOD</name>
        <rename>Payment Method</rename>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>PARENT_TRANSACTION_ID</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>REFUND_AMOUNT</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>REFUND_TAX_AMOUNT</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>REFUND_TOTAL_AMOUNT</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>GROSS_RS</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>TAXES_RS</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>TOTAL_RS</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>microRS</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>CTE_100</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>RS_PERCENTAGE</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>        <select_unspecified>N</select_unspecified>
      <remove>        <name>OPERATION</name>
      </remove>      <remove>        <name>RATING_TIMESTAMP</name>
      </remove>      <remove>        <name>OPERATOR_CODE</name>
      </remove>      <remove>        <name>finalParameterValue</name>
      </remove>      <remove>        <name>microRS</name>
      </remove>      <remove>        <name>CTE_100</name>
      </remove>      <remove>        <name>OPERATOR_ID</name>
      </remove>      <remove>        <name>PRODUCT_CLASS</name>
      </remove>      <remove>        <name>REFUND_REASON</name>
      </remove>      <remove>        <name>APP_ID</name>
      </remove>      <remove>        <name>rsAmount</name>
      </remove>      <remove>        <name>finalTaxes</name>
      </remove>      <remove>        <name>finalAftTaxes</name>
      </remove>      <remove>        <name>RS_PERCENTAGE</name>
      </remove>      <remove>        <name>REFUND_AMOUNT</name>
      </remove>      <remove>        <name>REFUND_TAX_AMOUNT</name>
      </remove>      <remove>        <name>REFUND_TOTAL_AMOUNT</name>
      </remove>      <remove>        <name>ORG_TRANSACTION_ID</name>
      </remove>      <remove>        <name>PARENT_TRANSACTION_ID</name>
      </remove>      <remove>        <name>EVENT_ID</name>
      </remove>    </fields>     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>1350</xloc>
      <yloc>525</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>select fields for charge search</name>
    <type>SelectValues</type>
    <description/>
    <distribute>N</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <fields>      <field>        <name>OPERATION</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>RATING_TIMESTAMP</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>OPERATOR_CODE</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>finalParameterValue</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>rsAmount</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>finalTaxes</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>finalAftTaxes</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>OPERATOR_ID</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>CURRENCY</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>PRODUCT_CLASS</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>REFUND_REASON</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>ORG_TRANSACTION_ID</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>        <select_unspecified>N</select_unspecified>
      <remove>        <name>OPERATION</name>
      </remove>      <remove>        <name>RATING_TIMESTAMP</name>
      </remove>      <remove>        <name>OPERATOR_CODE</name>
      </remove>      <remove>        <name>rsAmount</name>
      </remove>      <remove>        <name>finalTaxes</name>
      </remove>      <remove>        <name>finalAftTaxes</name>
      </remove>      <remove>        <name>OPERATOR_ID</name>
      </remove>      <remove>        <name>CURRENCY</name>
      </remove>      <remove>        <name>finalParameterValue</name>
      </remove>      <remove>        <name>PRODUCT_CLASS</name>
      </remove>      <remove>        <name>REFUND_REASON</name>
      </remove>    </fields>     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>650</xloc>
      <yloc>800</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>select report fields</name>
    <type>SelectValues</type>
    <description/>
    <distribute>N</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <fields>      <field>        <name>APP_ID</name>
        <rename>APPLICATION_ID</rename>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>RATING_TIMESTAMP</name>
        <rename>ACTIVITY_DATE</rename>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>OPERATION</name>
        <rename>ACTIVITY_TYPE</rename>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>finalTaxes</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>REFUND_AMOUNT</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>RS_PERCENTAGE</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>OPERATOR_CODE</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>finalParameterValue</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>rsAmount</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>finalAftTaxes</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>microRS</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>CTE_100</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>CURRENCY</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>OPERATOR_ID</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>PRODUCT_CLASS</name>
        <rename>APPLICATION_CLASS</rename>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>REFUND_REASON</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>EVENT_ID</name>
        <rename/>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>GROSS_RS</name>
        <rename>GROSS_AMOUNT</rename>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>TAXES_RS</name>
        <rename>TAX_AMOUNT</rename>
        <length>-2</length>
        <precision>-2</precision>
      </field>      <field>        <name>TOTAL_RS</name>
        <rename>TOTAL_AMOUNT</rename>
        <length>-2</length>
        <precision>-2</precision>
      </field>        <select_unspecified>N</select_unspecified>
      <remove>        <name>OPERATOR_CODE</name>
      </remove>      <remove>        <name>finalParameterValue</name>
      </remove>      <remove>        <name>rsAmount</name>
      </remove>      <remove>        <name>microRS</name>
      </remove>      <remove>        <name>CTE_100</name>
      </remove>      <remove>        <name>OPERATOR_ID</name>
      </remove>      <remove>        <name>finalTaxes</name>
      </remove>      <remove>        <name>finalAftTaxes</name>
      </remove>    </fields>     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>1250</xloc>
      <yloc>675</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>sort by rating_timestamp</name>
    <type>SortRows</type>
    <description/>
    <distribute>N</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
      <directory>%%java.io.tmpdir%%</directory>
      <prefix>out</prefix>
      <sort_size>1000000</sort_size>
      <free_memory/>
      <compress>N</compress>
      <compress_variable/>
      <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>RATING_TIMESTAMP</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
      </field>
    </fields>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>1250</xloc>
      <yloc>525</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>sort for Rs join</name>
    <type>SortRows</type>
    <description/>
    <distribute>Y</distribute>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
      <directory>%%java.io.tmpdir%%</directory>
      <prefix>out</prefix>
      <sort_size>1000000</sort_size>
      <free_memory/>
      <compress>N</compress>
      <compress_variable/>
      <unique_rows>N</unique_rows>
    <fields>
      <field>
        <name>PRODUCT_CLASS</name>
        <ascending>Y</ascending>
        <case_sensitive>N</case_sensitive>
      </field>
    </fields>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>350</xloc>
      <yloc>125</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step_error_handling>
  </step_error_handling>
   <slave-step-copy-partition-distribution>
</slave-step-copy-partition-distribution>
   <slave_transformation>N</slave_transformation>
</transformation>
